<div class="container">
    <mat-card>
        <mat-card-header>
            <mat-card-title>Mis Solicitudes de Vacaciones</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <div class="welcome-message" style="margin-bottom: 20px; color: #1976d2; font-weight: 500;">
                Bienvenido a la plataforma InfiniHR, puede revisar sus vacaciones.
            </div>
            
            <div *ngIf="userInfo?.rol === 'empleado' || userInfo?.rol === 'ROLE_EMPLEADO'" class="user-panel" style="margin-bottom: 16px; background: #e3f2fd; padding: 10px; border-radius: 6px; font-weight: 500; color: #1976d2;">
                Empleado | Usuario: {{ userInfo?.username }} | ID: {{ userInfo?.id }}
            </div>
            
            <div class="actions-container">
                <button mat-raised-button color="primary" (click)="solicitarVacacion()">
                    <mat-icon>add</mat-icon> Solicitar Vacaciones
                </button>
            </div>
            
            <div *ngIf="loading" class="loading-spinner">
                <mat-spinner diameter="40"></mat-spinner>
            </div>
            
            <div *ngIf="error" class="error-message">
                <p>{{ error }}</p>
                <p *ngIf="error.includes('404')">
                    El endpoint para vacaciones de empleado aún no está implementado en el backend. 
                    Por favor verifique que existe la ruta /api/vacaciones/empleado.
                </p>
            </div>
            
            <div *ngIf="!loading && !error">
                <table mat-table [dataSource]="vacaciones" class="mat-elevation-z2 full-width">
                    <!-- ID Column -->
                    <ng-container matColumnDef="id">
                        <th mat-header-cell *matHeaderCellDef>ID</th>
                        <td mat-cell *matCellDef="let element">{{ element.id }}</td>
                    </ng-container>
                    
                    <!-- Fecha Inicio Column -->
                    <ng-container matColumnDef="fechaInicio">
                        <th mat-header-cell *matHeaderCellDef>Fecha Inicio</th>
                        <td mat-cell *matCellDef="let element">{{ element.fechaInicio | date:'dd/MM/yyyy' }}</td>
                    </ng-container>
                    
                    <!-- Fecha Fin Column -->
                    <ng-container matColumnDef="fechaFin">
                        <th mat-header-cell *matHeaderCellDef>Fecha Fin</th>
                        <td mat-cell *matCellDef="let element">{{ element.fechaFin | date:'dd/MM/yyyy' }}</td>
                    </ng-container>
                    
                    <!-- Estado Column -->
                    <ng-container matColumnDef="estado">
                        <th mat-header-cell *matHeaderCellDef>Estado</th>
                        <td mat-cell *matCellDef="let element" [ngClass]="'estado-' + element.estado.toLowerCase()">
                            {{ element.estado }}
                        </td>
                    </ng-container>
                    
                    <!-- Motivo Column -->
                    <ng-container matColumnDef="motivo">
                        <th mat-header-cell *matHeaderCellDef>Motivo</th>
                        <td mat-cell *matCellDef="let element">{{ element.motivo }}</td>
                    </ng-container>
                    
                    <!-- Acciones Column -->
                    <ng-container matColumnDef="acciones">
                        <th mat-header-cell *matHeaderCellDef>Acciones</th>
                        <td mat-cell *matCellDef="let element">
                            <button mat-icon-button color="warn" *ngIf="element.estado === 'Pendiente'" 
                                    matTooltip="Cancelar solicitud">
                                <mat-icon>delete</mat-icon>
                            </button>
                        </td>
                    </ng-container>
                    
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>
                
                <div *ngIf="vacaciones.length === 0" class="no-data">
                    No tienes solicitudes de vacaciones.
                </div>
            </div>
        </mat-card-content>
    </mat-card>
</div>